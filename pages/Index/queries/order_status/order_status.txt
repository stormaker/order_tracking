SELECT zt,ZTMC,sum(qty)AS SUM,COUNT(Qty) AS COUNT FROM ordinfo WHERE (ZT<19 AND ZT<>0) AND ExFactory<=  (SELECT DATE_ADD(
    DATE_SUB(
        CURDATE(), 
        INTERVAL (WEEKDAY(CURDATE())) DAY
    ), 
    INTERVAL 14 DAY
) + INTERVAL 4 DAY ) GROUP BY ZTMC ORDER BY ZT;